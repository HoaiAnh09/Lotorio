<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Thông tin thanh toán - Lotorio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Baloo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Baloo', sans-serif; background: #f5f5f5; }
    .payment-options {
      display: flex;
      justify-content: space-around;
      gap: 20px;
      margin-top: 10px;
    }
    .payment-option {
      cursor: pointer;
      text-align: center;
      padding: 10px;
      border: 2px solid transparent;
      border-radius: 10px;
      transition: 0.3s;
    }
    .payment-option input {
      display: none;
    }
    .payment-option img {
      width: 64px;
      height: 64px;
    }
    .payment-option input:checked + img,
    .payment-option:hover {
      border: 2px solid #f7c600;
      border-radius: 10px;
      background: #fffbe6;
    }
  </style>
</head>
<body>

<!-- Navigation will be injected here -->
<div id="nav-placeholder"></div>

<main class="container mx-auto p-6 grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl">

  <!-- Danh sách món ăn -->
  <section class="md:col-span-2 bg-white p-6 rounded shadow">
    <h2 class="text-xl font-bold mb-4">← Thông tin thanh toán</h2>
    <div id="order-summary" class="space-y-4"></div>

    <!-- Ghi chú -->
    <div class="mt-6">
      <h3 class="font-bold mb-2">Ghi chú</h3>
      <textarea class="w-full border p-3 rounded resize-none" rows="2" placeholder="Ghi chú cho quán..."></textarea>
    </div>
  </section>

  <!-- Thông tin giao hàng + thanh toán -->
  <section class="bg-white p-6 rounded shadow space-y-4">
    <div>
      <h3 class="font-bold">Địa chỉ giao hàng</h3>
      <p class="mt-1 font-medium">175 Tây Sơn, Phố Tây Sơn, Đống Đa, Hà Nội, 100000, Việt Nam</p>
      <p class="text-sm text-gray-500">Chi nhánh cửa hàng</p>
    </div>

    <div>
      <h3 class="font-bold">Thông tin người nhận</h3>
      <p>Họ tên: Nguyễn Văn A</p>
      <p>SDT người nhận: 0123456789</p>
    </div>

    <div>
      <h3 class="font-bold">Phương thức thanh toán</h3>
      <div class="payment-options">
        <label class="payment-option">
          <input type="radio" name="payment" value="cash" checked>
          <img src="https://img.icons8.com/color/64/cash-in-hand.png" alt="Tiền mặt">
          <div>Tiền mặt</div>
        </label>
        <label class="payment-option">
          <input type="radio" name="payment" value="bank">
          <img src="https://img.icons8.com/color/64/bank-cards.png" alt="Chuyển khoản">
          <div>Chuyển khoản</div>
        </label>
      </div>
    </div>

    <!-- QR code -->
    <div id="qr-code" style="display:none; text-align:center;">
      <img src="img/QR-code.jpg" alt="QR chuyển khoản" class="w-32 h-32 mx-auto mb-2">
      <div>Quét mã để chuyển khoản</div>
    </div>

    <div class="border-t pt-4 font-bold text-lg" id="total-amount">Tổng tiền: 0 đ</div>
    <button class="order-btn bg-yellow-400 w-full py-3 rounded-lg text-black font-semibold hover:bg-yellow-300">
      Xác nhận thanh toán
    </button>
  </section>
</main>

<!-- Footer -->
<div id="footer-placeholder"></div>

<script>
  // Inject nav và footer
  fetch('nav.html')
    .then(res => res.text())
    .then(data => document.getElementById('nav-placeholder').innerHTML = data);

  fetch('footer.html')
    .then(res => res.text())
    .then(data => document.getElementById('footer-placeholder').innerHTML = data);

  // Hiển thị danh sách món ăn
  document.addEventListener('DOMContentLoaded', () => {
    const cart = JSON.parse(localStorage.getItem('cart') || '[]');
    const orderSummary = document.getElementById('order-summary');
    let total = 0;
    let html = '';

    cart.forEach(item => {
      total += item.price * item.qty;
      html += `
        <div class="flex items-center justify-between border-b pb-2">
          <div class="flex items-center gap-4">
            <img src="https://via.placeholder.com/80" alt="${item.name}" class="w-20 h-20 object-cover rounded">
            <div>
              <p class="font-semibold">${item.name}</p>
              <p class="text-sm text-gray-500">Số lượng: ${item.qty}</p>
            </div>
          </div>
          <p class="font-bold">${(item.price * item.qty).toLocaleString()} đ</p>
        </div>
      `;
    });

    orderSummary.innerHTML = html;
    document.getElementById('total-amount').textContent = 'Tổng tiền: ' + total.toLocaleString() + ' đ';

    // Chọn phương thức thanh toán
    document.querySelectorAll('input[name="payment"]').forEach(input => {
      input.addEventListener('change', () => {
        document.getElementById('qr-code').style.display = input.value === 'bank' ? 'block' : 'none';
      });
    });

    // Nút xác nhận
    document.querySelector('.order-btn').addEventListener('click', () => {
      if (cart.length === 0) {
        alert('Giỏ hàng trống!');
        return;
      }

      const order = {
        id: Date.now(),
        items: cart,
        total: total,
        status: 'cho-xac-nhan',
        createdAt: new Date().toLocaleString()
      };

      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      orders.unshift(order);
      localStorage.setItem('orders', JSON.stringify(orders));
      localStorage.removeItem('cart');

      alert('Thanh toán thành công!');
      window.location.href = 'DonHang.html';
    });
  });
</script>
</body>
</html>
